<div id="myModal" class="modal">
    <div id="myCont" class="modal-content">
        <header class="avatar-modal-header"> Change Avatar Name </header>

        <body class="avatar-modal-outer">
            <input maxlength="25" class="avatar-modal-input" type="text" [(ngModel)]="newAvatarName" placeholder="Enter name">
        </body>
        <footer style="text-align: right">
            <button class="btn btn-primary" (click)="createNewAvatar()"> Submit </button>
            <button class="btn" (click)="closeModal()"> Cancel </button>
        </footer>
    </div>
</div>

<div style="border:solid green 1px; text-align: center; width: 100%">
    <div class="navMenuForMobile">
        <i *ngIf="!isMobileLanding" [routerLink]="['/']" class="navMenuForMobileItem fa fa-newspaper-o"></i>
        <i *ngIf="isMobileLanding" [routerLink]="['/']" class="navMenuForMobileItem_col fa fa-newspaper-o"></i>
        <i *ngIf="!isMobileTrending" (click)="getTopChats()" class="navMenuForMobileItem fa fa-fire"></i>
        <i *ngIf="isMobileTrending" (click)="getTopChats()" class="navMenuForMobileItem_col fa fa-fire"></i>
        <i *ngIf="!isMobileUserChats" (click)="getUserChat()" class="navMenuForMobileItem fa fa-user-o"></i>
        <i *ngIf="isMobileUserChats" (click)="getUserChat()" class="navMenuForMobileItem_col fa fa-user-o"></i>
    </div>
</div>
<div id="profModal" class="profile-modal">
    <div id="myCont" style="border: solid lightgray 1px;" class="profile-modal-content">
        <header style="margin-bottom: 10px;" class="avatar-modal-header"> Profile Information </header>
        <form [formGroup]="updateProfileForm">
            <div class="form-group" [ngClass]="{'has-danger': updateProfileForm.controls.email.invalid && updateProfileForm.controls.email.dirty,
                'has-success': updateProfileForm.controls.email.valid && updateProfileForm.controls.email.dirty}">
                <input class="form-control" type="text" formControlName="email">
            </div>

            <div class="form-group" [ngClass]="{'has-danger': updateProfileForm.controls.phone.invalid && updateProfileForm.controls.phone.dirty,
            'has-success': updateProfileForm.controls.phone.valid && updateProfileForm.controls.phone.dirty}">
                <input class="form-control" type="text" formControlName="phone">
            </div>

            <div class="form-group" [ngClass]="{'has-danger': updateProfileForm.controls.occupation.invalid && updateProfileForm.controls.occupation.dirty,
            'has-success': updateProfileForm.controls.occupation.valid && updateProfileForm.controls.occupation.dirty}">
                <input class="form-control" type="text" formControlName="occupation">
            </div>

            <div style="text-align: right">
                <button class="btn btn-primary" (click)='saveUpdateProfile()' [disabled]="!updateProfileForm.valid"> Update Profile </button>
            </div>
            <br>
        </form>
        <div>
            <div>
                <fieldset>
                    <form [formGroup]="changePasswordForm">
                        <div class="form-group" [ngClass]="{'has-danger': changePasswordForm.controls.opass.invalid && changePasswordForm.controls.opass.dirty,
                            'has-success': changePasswordForm.controls.opass.valid && changePasswordForm.controls.opass.dirty}">
                            <input class="form-control" id="opass" type="password" formControlName="opass" placeholder="Enter old password">
                        </div>
                        <div class="form-group" [ngClass]="{'has-danger': changePasswordForm.controls.pass.invalid && changePasswordForm.controls.pass.dirty,
                        'has-success': changePasswordForm.controls.pass.valid && changePasswordForm.controls.pass.dirty}">
                            <input class="form-control" id="pass" type="password" formControlName="pass" placeholder="Enter new password">
                        </div>
                        <div class="form-group" [ngClass]="{'has-danger': changePasswordForm.controls.cpass.invalid && changePasswordForm.controls.cpass.dirty,
                        'has-success': changePasswordForm.controls.cpass.valid && changePasswordForm.controls.cpass.dirty}">
                            <input class="form-control" id="cpass" type="password" formControlName="cpass" placeholder="Confirm new password">
                        </div>
                        <div (click)="showPassword()" style="float:left; margin-left: 5px">
                            <input type="checkbox" />
                            <label> Show password </label>
                        </div>
                        <div style="text-align: right">
                            <button [disabled]="!changePasswordForm.valid" class="btn btn-primary btn-sm" (click)="saveNewPassword()"> Save Password </button>
                        </div>
                    </form>
                </fieldset>
            </div>
        </div>
    </div>
</div>

<div id="myModal" class="chatModal">
    <div id="myCont" style="border: solid lightgray 1px;" class="chatModal-content">
        <header class="chat-modal-header">
            <div *ngIf="selectedChat.owner!=null" style=" font-size:65%;float:left">{{selectedChat.owner.name}}</div>
            <div style="float:right">
                <div style="font-size: 60%" *ngIf="isChatModal">
                    <!--<i *ngIf="selectedChat.owner.user == id" class="fa fa-edit"></i>-->
                    <i *ngIf="selectedChat.owner.user == id" class="fa fa-remove"></i>
                    <i *ngIf="selectedChat.owner.user != id && selectedChat.isReported" style="color: red" class="fa fa-thumbs-o-down"></i>
                    <i *ngIf="selectedChat.owner.user != id && !selectedChat.isReported" (click)="reportChat(chat)" class="fa fa-thumbs-o-down"></i>
                </div>
            </div>
        </header>
        <div class="chat-created-date" *ngIf="selectedChat.createdDate!=null">
            {{selectedChat.createdDate}}
        </div>
        <hr>

        <body>
            <p style="overflow-y: auto" *ngIf="selectedChat.body!=null" class="chat-modal-body">
                {{selectedChat.body}}
            </p>
            <div *ngIf="selectedChat.post!==null || selectedChat.post.length > 0" style="max-height:130px; overflow-y: auto">
                <div *ngFor="let item of selectedChat.post" class="comment-main-div">
                    <div class="comment-avatar_name">
                        <strong>{{item.avatar.name}}</strong>
                    </div>
                    <div class="comment-body">{{item.body}} </div>
                    <div class="comment-createdDate"> {{item.createdDate}} </div>
                </div>
            </div>
            <div *ngIf="selectedChat.post!==null || selectedChat.post.length > 0">
            </div>
            <hr>
            <div style="width:100%" class="chat-header-likescomments-div">
                <div *ngIf="isChatModal">
                    <label *ngIf="selectedChat.likes.length > 0"> {{selectedChat.likes.length}}</label>
                    <label *ngIf="selectedChat.likes.length == 0"></label>
                    <i *ngIf="selectedChat.isLiked" style="color: red;" class="fa fa-heart"></i>
                    <i *ngIf="!selectedChat.isLiked" (click)="createNewChatlike(selectedChat._id)" class="fa fa-heart-o"></i>
                    <label *ngIf="selectedChat.post.length > 0" style="margin-left:10px"> {{selectedChat.post.length}}</label>
                    <label *ngIf="selectedChat.post.length == 0" style="margin-left:10px"></label>
                    <i class="fa fa-comment-o"></i>
                </div>
            </div>
            <input class="chat-modal-input" id="chat-modal-input" [ngModel]="message" (ngModelChange)="postMessageChanged($event,selectedChat._id)"
                placeholder="Enter your comment" type="text" />
        </body>

        <footer class="chat-modal-footer-buttons">
            <button class="btn btn-primary" (click)="createNewPost(selectedChat)"> Comment </button>
            <button class="btn btn-primary" (click)="closeChatModal()"> Cancel </button>
        </footer>
    </div>
</div>

<div class="chat-component-main-div">
    <div class="chat-outer-div">
        <header class="new-chat-as-header">
            <div class="new-chat-outer-div">
                <div>

                    <body (click)="openAvatarModal()" class="avatar-name">Posting as
                        <strong *ngIf="currentAvatar.name!=null">{{currentAvatar.name}} </strong>
                    </body>
                </div>
                <textarea class="input-no-border-100" maxlength="1001" [(ngModel)]="chatBody" placeholder="Say something......"></textarea>
                <button style="display: block" class="btn btn-primary btn-md" (click)="createNewChat()"> post </button>
            </div>
        </header>
        <div *ngFor="let chat of listOfChats">
            <div class="chat-card-main-div">
                <div class="chat-card-main-div-header">
                    <div class="chat-header-tittle" style="margin-left:0px; width:100%; background-color: crimson; opacity:0.3; height:120px; border: solid red 1px;background-color:darkred">
                        <button > Cancel </button>
                        <button class="btn btn-danger btn-sm"> Delete </button>
                    </div>
           <!--         <div class="chat-header-tittle"> {{chat.owner.name}} </div>-->
                    <div class="avatar-name">
                    </div>
                </div>
                <div class="chat-created-date"> {{chat.createdDate}} </div>
                <div class="chatMenu">
                    <!--<i *ngIf="chat.owner.user === id" class="fa fa-edit"> </i>-->
                    <i *ngIf="chat.owner.user === id" (click)="deleteChat(chat)" class="fa fa-remove"> </i>
                    <i *ngIf="chat.owner.user !== id && !chat.isReported" (click)="reportChat(chat)" class="fa fa-thumbs-o-down"> </i>
                    <i *ngIf="chat.owner.user !== id && chat.isReported" style="color: red" class="fa fa-thumbs-o-down"> </i>
                </div>
                <div>
                 
           <hr class="hr-division">
                    <p (click)="openChatModal(chat)" class="chat-body">
                        {{chat.body}}
                    </p>
                </div>
                <div class="outer-comment-div">
                    <div *ngIf="chat.post.length > 0" style="overflow-y: auto">
                        <div class="comment-main-div" *ngFor="let item of chat.post">
                            <div style="float:right">
                                <i *ngIf="item.avatar.user=== id" (click)="deletePost(chat._id,item._id)" class="fa fa-remove"></i>
                                <i *ngIf="item.avatar.user!==id" class="fa fa-thumbs-o-down"></i>
                            </div>
                            <div>
                                <strong>{{item.avatar.name}}</strong>
                            </div>
                            <div> {{item.body}} </div>
                            <div class="comment-createdDate">{{item.createdDate}} </div>
                        </div>
                    </div>
                </div>
                <footer class="chat-footer">
                    <label *ngIf="chat.likes.length > 0 && chat.isLiked" class="chat-likes-comment-labels">{{chat.likes.length}} </label>
                    <label *ngIf="chat.likes.length > 0 && !chat.isLiked" class="chat-likes-comment-labels">{{chat.likes.length}} </label>
                    <label class="chat-likes-comment-labels" *ngIf="chat.likes.length == 0"></label>
                    <i *ngIf="chat.isLiked" style="color: red;" class="fa fa-heart"></i>
                    <i *ngIf="!chat.isLiked" (click)="createNewChatlike(chat._id)" class="fa fa-heart-o"></i>
                    <label class="chat-likes-comment-labels" *ngIf="chat.post.length > 0">{{chat.post.length}} </label>
                    <label class="chat-likes-comment-labels" *ngIf="chat.post.length == 0"> </label>
                    <i class="fa fa-comment-o fa-1x"></i>
                    <input type="text" [ngModel]="message" maxlength="709" (ngModelChange)="postMessageChanged($event,chat._id)" placeholder="Enter your comment"
                        class="comment-input">
                    <i class="comment-send-icon fa fa-send" style="color: steelblue" (click)="createNewPost(chat)"></i>
                </footer>
            </div>
        </div>
    </div>
</div>